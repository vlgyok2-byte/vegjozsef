<!doctype html>
<html lang="hu">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Gyakorló: jelen igeidők — Present Simple / Continuous / Perfect / Perfect Continuous</title>
<style>
  :root{--bg:#f6f8fb;--card:#fff;--accent:#0b74de;--good:#d4f8d4;--bad:#ffd6d6;--muted:#666}
  body{font-family:Inter,system-ui,Roboto,Arial;margin:18px;background:var(--bg);color:#111}
  h1{color:var(--accent);margin:0 0 6px;font-size:1.4rem}
  .card{background:var(--card);padding:14px;border-radius:10px;box-shadow:0 6px 18px rgba(12,24,40,.06);margin-bottom:12px;max-width:960px}
  .controls{display:flex;gap:8px;align-items:center;margin-bottom:12px;flex-wrap:wrap}
  button{background:var(--accent);color:#fff;border:none;padding:8px 12px;border-radius:8px;cursor:pointer;font-weight:600}
  button.ghost{background:#e9f2ff;color:var(--accent);border:1px solid #cfe4ff}
  .qcard{padding:12px;border-radius:8px;background:linear-gradient(180deg,#fff,#fbfdff);margin-bottom:10px;border:1px solid #eef6ff}
  .translation{font-style:italic;color:var(--muted);margin-top:6px}
  input[type=text]{padding:8px;border-radius:6px;border:1px solid #d1d7e0;width:100%;max-width:720px;box-sizing:border-box}
  .buttons{display:flex;gap:8px;margin-top:8px;flex-wrap:wrap}
  .explain{background:#f0f8ff;padding:10px;border-left:4px solid var(--accent);border-radius:6px;margin-top:8px;display:none}
  .correct{border-left:6px solid #43b77a;background:#f0fff4}
  .wrong{border-left:6px solid #f26b6b;background:#fff5f5}
  #summary{display:none;margin-top:12px;padding:12px;background:#fff;border-radius:8px;box-shadow:0 4px 10px rgba(0,0,0,0.04)}
  .wrongList p{margin:8px 0;padding:8px;background:#fff5f5;border-radius:6px}
  .statsRow{display:flex;gap:12px;flex-wrap:wrap;margin-top:8px}
  .small{font-size:.9rem;color:var(--muted)}
  @media(max-width:640px){input[type=text]{width:100%}}
</style>
</head>
<body>
  <div class="card">
    <h1>Gyakorló: jelen igeidők</h1>
    <p class="small">Időtartam: <strong>Present Simple, Present Continuous, Present Perfect, Present Perfect Continuous</strong>. Írd be a hiányzó igealakot (pl. <code>works</code>, <code>is working</code>, <code>have finished</code>, <code>have been working</code>). Azonnal kapsz visszajelzést és magyarázatot. A „Következő” gomb új kérdést ad hozzá az oldal aljára; az előzőek megmaradnak.</p>

    <div class="controls">
      <label style="display:flex;align-items:center;gap:8px"><input type="checkbox" id="shuffle" checked> <span class="small">Véletlenszerű sorrend</span></label>
      <div style="margin-left:auto" class="small">Kérdések száma: <span id="totalCount">0</span></div>
    </div>

    <div id="quizArea"></div>

    <div id="summary" class="card">
      <h3>Összegzés</h3>
      <div class="statsRow">
        <div><strong>Megjelenített:</strong> <span id="totalShown">0</span></div>
        <div><strong>Megválaszolt:</strong> <span id="answeredCount">0</span></div>
        <div><strong>Helyes:</strong> <span id="correctCount">0</span></div>
        <div><strong>Százalék:</strong> <span id="percent">0%</span></div>
      </div>
      <div id="wrongBlock"></div>
      <div style="margin-top:10px"><button id="restartBtn" class="ghost">Újrakezd</button></div>
    </div>
  </div>

<script>
/* ====== Kérdésbank (20 tétel: 5-5 minden igeidőből) ====== */
const BANK = 
[
  {
    "q": "She ______ (work) in a bank.",
    "a": [
      "works"
    ],
    "tense": "Present Simple",
    "hu": "Egy bankban dolgozik.",
    "explain": "Present Simple — szokások/állapotok, 3. személyhez -s a végződés."
  },
  {
    "q": "I usually ______ (get up) at 7.",
    "a": [
      "get up"
    ],
    "tense": "Present Simple",
    "hu": "Általában 7-kor kelek fel.",
    "explain": "Present Simple — ismétlődő cselekvések."
  },
  {
    "q": "My parents ______ (live) in Hungary.",
    "a": [
      "live"
    ],
    "tense": "Present Simple",
    "hu": "A szüleim Magyarországon élnek.",
    "explain": "Present Simple — állapot, tény."
  },
  {
    "q": "He ______ (not / like) coffee.",
    "a": [
      "does not like",
      "doesn't like"
    ],
    "tense": "Present Simple",
    "hu": "Nem szereti a kávét.",
    "explain": "Tagadás: do/does + not + alapige (3. személy: does not)."
  },
  {
    "q": "______ she ______ (speak) English?",
    "a": [
      "does she speak",
      "does she speak english"
    ],
    "tense": "Present Simple",
    "hu": "Beszél angolul?",
    "explain": "Kérdés: Do/Does + alany + alapige (3. személy: does)."
  },
  {
    "q": "They often ______ (go) to the gym.",
    "a": [
      "go"
    ],
    "tense": "Present Simple",
    "hu": "Gyakran járnak edzőterembe.",
    "explain": "Present Simple — rendszeres tevékenység."
  },
  {
    "q": "It ______ (rain) a lot in autumn.",
    "a": [
      "rains"
    ],
    "tense": "Present Simple",
    "hu": "Ősszel sokat esik az eső.",
    "explain": "Természetes tény, általános igazság."
  },
  {
    "q": "We ______ (study) English every day.",
    "a": [
      "study"
    ],
    "tense": "Present Simple",
    "hu": "Minden nap angolt tanulunk.",
    "explain": "Ismétlődő, szokásos cselekvés."
  },
  {
    "q": "He always ______ (come) late.",
    "a": [
      "comes"
    ],
    "tense": "Present Simple",
    "hu": "Mindig későn jön.",
    "explain": "Szokás kifejezése, always + Present Simple."
  },
  {
    "q": "I ______ (not / eat) meat.",
    "a": [
      "do not eat",
      "don't eat"
    ],
    "tense": "Present Simple",
    "hu": "Nem eszem húst.",
    "explain": "Tagadás: do + not + alapige."
  },
  {
    "q": "I ______ (study) English at the moment.",
    "a": [
      "am studying",
      "i am studying"
    ],
    "tense": "Present Continuous",
    "hu": "Éppen angolt tanulok.",
    "explain": "am/is/are + -ing; éppen zajló cselekvés."
  },
  {
    "q": "They ______ (watch) TV now.",
    "a": [
      "are watching"
    ],
    "tense": "Present Continuous",
    "hu": "Most tévét néznek.",
    "explain": "Folyamatban lévő esemény."
  },
  {
    "q": "He ______ (not / listen) to music now.",
    "a": [
      "is not listening",
      "isn't listening"
    ],
    "tense": "Present Continuous",
    "hu": "Most nem hallgat zenét.",
    "explain": "Tagadás: am/is/are + not + -ing."
  },
  {
    "q": "What ______ you ______ (do) at the moment?",
    "a": [
      "are you doing",
      "what are you doing"
    ],
    "tense": "Present Continuous",
    "hu": "Mit csinálsz most?",
    "explain": "Kérdés: am/is/are + alany + -ing."
  },
  {
    "q": "She ______ (prepare) dinner this evening.",
    "a": [
      "is preparing"
    ],
    "tense": "Present Continuous",
    "hu": "Ma este vacsorát készít.",
    "explain": "Jövőre vonatkozó tervként is használható."
  },
  {
    "q": "Look! The children ______ (play) in the park.",
    "a": [
      "are playing"
    ],
    "tense": "Present Continuous",
    "hu": "Nézd! A gyerekek a parkban játszanak.",
    "explain": "Éppen most zajló cselekvés."
  },
  {
    "q": "I ______ (not / work) today.",
    "a": [
      "am not working"
    ],
    "tense": "Present Continuous",
    "hu": "Ma nem dolgozom.",
    "explain": "Ideiglenes állapot."
  },
  {
    "q": "Listen! The birds ______ (sing).",
    "a": [
      "are singing"
    ],
    "tense": "Present Continuous",
    "hu": "Figyelj! A madarak énekelnek.",
    "explain": "Folyamatban lévő esemény a beszéd pillanatában."
  },
  {
    "q": "He ______ (wear) a new jacket today.",
    "a": [
      "is wearing"
    ],
    "tense": "Present Continuous",
    "hu": "Ma új kabátot visel.",
    "explain": "Ideiglenes állapot, változás."
  },
  {
    "q": "We ______ (stay) in a hotel this week.",
    "a": [
      "are staying"
    ],
    "tense": "Present Continuous",
    "hu": "Ezen a héten hotelben szállunk meg.",
    "explain": "Ideiglenes helyzet."
  },
  {
    "q": "I ______ (finish) my homework.",
    "a": [
      "have finished"
    ],
    "tense": "Present Perfect",
    "hu": "Befejeztem a házimat.",
    "explain": "have/has + ige 3. alakja; van jelenbeli hatása."
  },
  {
    "q": "She ______ (visit) Paris three times.",
    "a": [
      "has visited"
    ],
    "tense": "Present Perfect",
    "hu": "Háromszor járt Párizsban.",
    "explain": "Tapasztalat kifejezése."
  },
  {
    "q": "We ______ (not / see) that movie yet.",
    "a": [
      "have not seen",
      "haven't seen"
    ],
    "tense": "Present Perfect",
    "hu": "Még nem láttuk azt a filmet.",
    "explain": "Tagadás: have not + past participle."
  },
  {
    "q": "______ you ever ______ (be) to Italy?",
    "a": [
      "have you ever been"
    ],
    "tense": "Present Perfect",
    "hu": "Voltál már Olaszországban?",
    "explain": "Élettapasztalat kérdése."
  },
  {
    "q": "They ______ (live) here since 2018.",
    "a": [
      "have lived",
      "have been living"
    ],
    "tense": "Present Perfect",
    "hu": "2018 óta élnek itt.",
    "explain": "since/for időhatározókkal."
  },
  {
    "q": "I ______ (just / eat) breakfast.",
    "a": [
      "have just eaten"
    ],
    "tense": "Present Perfect",
    "hu": "Épp most reggeliztem.",
    "explain": "Just + Present Perfect: friss múltbeli esemény."
  },
  {
    "q": "He ______ (already / finish) the book.",
    "a": [
      "has already finished"
    ],
    "tense": "Present Perfect",
    "hu": "Már befejezte a könyvet.",
    "explain": "Already – már; Present Perfect."
  },
  {
    "q": "We ______ (never / meet) before.",
    "a": [
      "have never met"
    ],
    "tense": "Present Perfect",
    "hu": "Még sosem találkoztunk.",
    "explain": "Never – soha; élet tapasztalat."
  },
  {
    "q": "She ______ (break) her leg.",
    "a": [
      "has broken"
    ],
    "tense": "Present Perfect",
    "hu": "Eltörte a lábát.",
    "explain": "A múlt eseménye, de van jelenbeli következménye."
  },
  {
    "q": "They ______ (move) to a new house.",
    "a": [
      "have moved"
    ],
    "tense": "Present Perfect",
    "hu": "Új házba költöztek.",
    "explain": "Nemrég történt esemény, hatása most is érződik."
  },
  {
    "q": "I ______ (study) for two hours.",
    "a": [
      "have been studying"
    ],
    "tense": "Present Perfect Continuous",
    "hu": "Két órája tanulok.",
    "explain": "have/has been + -ing; időtartam a hangsúly."
  },
  {
    "q": "She ______ (work) here since April.",
    "a": [
      "has been working"
    ],
    "tense": "Present Perfect Continuous",
    "hu": "Április óta itt dolgozik.",
    "explain": "Múltban kezdődött, jelenben is tart."
  },
  {
    "q": "They ______ (play) tennis all morning.",
    "a": [
      "have been playing"
    ],
    "tense": "Present Perfect Continuous",
    "hu": "Egész délelőtt teniszeztek.",
    "explain": "Folyamat, ami nemrég ért véget vagy tart."
  },
  {
    "q": "How long ______ you ______ (wait)?",
    "a": [
      "have you been waiting"
    ],
    "tense": "Present Perfect Continuous",
    "hu": "Mióta vársz?",
    "explain": "How long + have/has + been + -ing."
  },
  {
    "q": "He ______ (not / exercise) recently.",
    "a": [
      "has not been exercising",
      "hasn't been exercising"
    ],
    "tense": "Present Perfect Continuous",
    "hu": "Mostanában nem edzett.",
    "explain": "Tagadás: have/has not been + -ing."
  },
  {
    "q": "I ______ (work) all day, and I’m tired.",
    "a": [
      "have been working"
    ],
    "tense": "Present Perfect Continuous",
    "hu": "Egész nap dolgoztam, és fáradt vagyok.",
    "explain": "A folyamat hatása most is érezhető."
  },
  {
    "q": "She ______ (cry); her eyes are red.",
    "a": [
      "has been crying"
    ],
    "tense": "Present Perfect Continuous",
    "hu": "Sírt; vörösek a szemei.",
    "explain": "A folyamat eredménye jelenben látszik."
  },
  {
    "q": "They ______ (travel) around Europe for months.",
    "a": [
      "have been travelling",
      "have been traveling"
    ],
    "tense": "Present Perfect Continuous",
    "hu": "Már hónapok óta utazgatnak Európában.",
    "explain": "Folyamatos tevékenység hosszabb időn keresztül."
  },
  {
    "q": "We ______ (wait) for you since noon.",
    "a": [
      "have been waiting"
    ],
    "tense": "Present Perfect Continuous",
    "hu": "Dél óta várunk rád.",
    "explain": "Since + időpont."
  },
  {
    "q": "It ______ (rain) all day.",
    "a": [
      "has been raining"
    ],
    "tense": "Present Perfect Continuous",
    "hu": "Egész nap esik az eső.",
    "explain": "Folyamat, ami most is tart."
  }
];

/* ====== logika ====== */
let pool = [];
let shown = [];    // store indices in pool that were rendered
let answers = {};  // idx in pool -> {user, ok, correct, q, hu, explain, tense}

function normalize(s){ return (s||'').toString().trim().toLowerCase().replace(/\s+/g,' '); }

function preparePool(){
  pool = BANK.map((t,i)=> ({...t, orig:i}));
  if(document.getElementById('shuffle').checked) pool = shuffle(pool);
  shown = [];
  answers = {};
  document.getElementById('quizArea').innerHTML = '';
  document.getElementById('summary').style.display = 'none';
  document.getElementById('totalCount').textContent = pool.length;
  updateSummaryCounts();
}

function shuffle(a){
  const b = a.slice();
  for(let i=b.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [b[i],b[j]]=[b[j],b[i]];
  }
  return b;
}

function renderNext(){
  if(pool.length===0) preparePool();
  const idx = shown.length;
  if(idx >= pool.length){ alert('Nincs több kérdés.'); return; }
  const item = pool[idx];
  const id = 'q'+idx;
  const wrapper = document.createElement('div');
  wrapper.className = 'qcard';
  wrapper.id = 'card-'+idx;
  wrapper.innerHTML = `
    <div><strong>${idx+1}.</strong> ${item.q} <span style="float:right;color:var(--muted)">${item.tense}</span></div>
    <div class="translation">${item.hu}</div>
    <div style="margin-top:8px"><input type="text" id="${id}" placeholder="Írd be a választ..."></div>
    <div class="buttons">
      <button type="button" onclick="checkSingle(${idx})">Ellenőrzés</button>
      <button type="button" onclick="renderNext()">Következő</button>
      <button type="button" onclick="finishTest()">Befejezem</button>
    </div>
    <div id="exp-${idx}" class="explain"></div>
  `;
  document.getElementById('quizArea').appendChild(wrapper);
  shown.push(idx);
  updateSummaryCounts();
}

function checkSingle(idx){
  const input = document.getElementById('q'+idx);
  const raw = (input.value||'').trim();
  const user = normalize(raw);
  const item = pool[idx];
  const corrects = (Array.isArray(item.a)? item.a : [item.a]).map(normalize);
  const expDiv = document.getElementById('exp-'+idx);
  const card = document.getElementById('card-'+idx);
  const ok = corrects.includes(user);
  answers[idx] = { user: raw, ok, correct: (Array.isArray(item.a)? item.a[0] : item.a), q: item.q, hu: item.hu, explain: item.explain, tense: item.tense };
  if(ok){
    card.classList.remove('wrong'); card.classList.add('correct');
    expDiv.style.display='block';
    expDiv.innerHTML = `<strong style="color:green">Helyes.</strong> <div style="margin-top:6px">${item.explain}</div>`;
  } else {
    card.classList.remove('correct'); card.classList.add('wrong');
    expDiv.style.display='block';
    expDiv.innerHTML = `<strong style="color:red">Helytelen.</strong> Helyes válasz: <b>${answers[idx].correct}</b><div style="margin-top:6px">${item.explain}</div>`;
  }
  updateSummaryCounts();
}

function updateSummaryCounts(){
  const totalShown = shown.length;
  const answeredCount = Object.keys(answers).length;
  const correctCount = Object.values(answers).filter(x=>x.ok).length;
  document.getElementById('totalShown').textContent = totalShown;
  document.getElementById('answeredCount').textContent = answeredCount;
  document.getElementById('correctCount').textContent = correctCount;
  const pct = answeredCount===0?0:Math.round((correctCount/answeredCount)*100);
  document.getElementById('percent').textContent = pct+'%';
  document.getElementById('totalCount').textContent = pool.length;
}

function finishTest(){
  // ensure any unanswered but filled fields are recorded
  shown.forEach(idx=>{
    if(!answers[idx]){
      const raw = (document.getElementById('q'+idx)?.value||'').trim();
      const user = normalize(raw);
      const item = pool[idx];
      const corrects = (Array.isArray(item.a)? item.a : [item.a]).map(normalize);
      const ok = corrects.includes(user);
      answers[idx] = { user: raw, ok, correct: (Array.isArray(item.a)? item.a[0] : item.a), q: item.q, hu: item.hu, explain: item.explain, tense: item.tense };
      const expDiv = document.getElementById('exp-'+idx);
      const card = document.getElementById('card-'+idx);
      if(ok){
        card.classList.add('correct');
        expDiv.style.display='block';
        expDiv.innerHTML = `<strong style="color:green">Helyes.</strong> <div style="margin-top:6px">${item.explain}</div>`;
      } else {
        card.classList.add('wrong');
        expDiv.style.display='block';
        expDiv.innerHTML = `<strong style="color:red">Helytelen.</strong> Helyes válasz: <b>${answers[idx].correct}</b><div style="margin-top:6px">${item.explain}</div>`;
      }
    }
  });
  // compile wrongs
  const answeredCount = Object.keys(answers).length;
  const correctCount = Object.values(answers).filter(x=>x.ok).length;
  const pct = answeredCount===0?0:Math.round((correctCount/answeredCount)*100);
  document.getElementById('answeredCount').textContent = answeredCount;
  document.getElementById('correctCount').textContent = correctCount;
  document.getElementById('percent').textContent = pct+'%';

  const wrongs = Object.values(answers).filter(x=>!x.ok);
  const wrongBlock = document.getElementById('wrongBlock');
  wrongBlock.innerHTML = '';
  if(wrongs.length){
    wrongBlock.innerHTML = '<h4>Hibás válaszok (javított listával):</h4><div class="wrongList">';
    wrongs.forEach((w,i)=>{
      wrongBlock.innerHTML += `<p><strong>${i+1}.</strong> ${w.q}<br><em>${w.hu}</em><br><strong>Te:</strong> ${w.user || '(üres)'}<br><strong>Helyes:</strong> ${w.correct}<br><small style="display:block;margin-top:6px">${w.explain}</small></p>`;
    });
    wrongBlock.innerHTML += '</div>';
  } else {
    wrongBlock.innerHTML = '<p>Gratulálok! Minden megadott válasz helyes volt.</p>';
  }

  document.getElementById('summary').style.display = 'block';
  // disable next button by disabling creation of new questions
  document.querySelectorAll('button').forEach(b=>{
    if(b.textContent.trim()==='Következő') b.disabled = true;
  });
}

function restart(){
  document.querySelectorAll('button').forEach(b=>b.disabled=false);
  preparePool();
  renderNext();
}

document.getElementById('shuffle').addEventListener('change', ()=>{
  preparePool();
  renderNext();
});

document.getElementById('restartBtn').addEventListener('click', restart);

// init
preparePool();
renderNext();

</script>
</body>
</html>
